"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var crypto=require("crypto"),serialize=_interopDefault(require("serialize-javascript")),Aes=require("aes-256-gcm"),serializeOptions={ignoreFunction:!0},delimiter="PB13A35";function encrypt(e,r){if(void 0===e)throw new Error("decrypted is undefined");"string"==typeof r&&null!=r||(r=crypto.randomBytes(16).toString("hex"));var t={DECRYPTED:e},i="";try{i=JSON.stringify(t)}catch(e){i=serialize(t,serializeOptions)}var n=Aes.encrypt(i,r);return""+n.ciphertext+delimiter+n.iv+delimiter+n.tag}function decrypt(encrypted,secret){var _encrypted$split=encrypted.split(delimiter),ciphertext=_encrypted$split[0],iv=_encrypted$split[1],tag=_encrypted$split[2],serialized=Aes.decrypt(ciphertext,iv,tag,secret),deserialized=eval("("+serialized+")");return deserialized.DECRYPTED}var createSecret=function(){return crypto.randomBytes(16).toString("hex")},createKey=createSecret,createIv=crypto.randomBytes(32).toString("hex"),randomString=function(e){return void 0===e&&(e=32),crypto.randomBytes(e).toString("hex")},index={encrypt:encrypt,decrypt:decrypt,createSecret:createSecret,createKey:createKey,createIv:createIv,randomString:randomString,randomBytes:crypto.randomBytes};Object.defineProperty(exports,"randomBytes",{enumerable:!0,get:function(){return crypto.randomBytes}}),exports.createIv=createIv,exports.createKey=createKey,exports.createSecret=createSecret,exports.decrypt=decrypt,exports.default=index,exports.encrypt=encrypt,exports.randomString=randomString;
//# sourceMappingURL=aes.cjs.production.min.js.map
