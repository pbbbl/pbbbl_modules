{"version":3,"file":"aes.cjs.development.js","sources":["../src/index.ts"],"sourcesContent":["\nimport {randomBytes} from 'crypto';\nconst Aes = require('aes-256-gcm');\nimport serialize from 'serialize-javascript';\nimport {SerializeJSOptions} from 'serialize-javascript';\nconst serializeOptions:SerializeJSOptions = {\n    ignoreFunction:true,\n}\nconst delimiter = `PB13A35`;\nfunction encrypt(decrypted:any,secret:string):string{\n    if(typeof decrypted == 'undefined') throw new Error(\"decrypted is undefined\");\n    if(typeof secret != 'string' || secret == null) {\n        secret = randomBytes(16).toString('hex');\n    }\n    const obj = {DECRYPTED:decrypted};\n    let serialized:string=''\n    try{\n        serialized = JSON.stringify(obj);\n    } catch {\n        serialized =  serialize(obj, serializeOptions)\n    }\n    \n    \n    const res = Aes.encrypt(serialized,secret);\n    const encrypted = `${res.ciphertext}${delimiter}${res.iv}${delimiter}${res.tag}`;\n    return encrypted;\n}\nfunction decrypt(encrypted:string,secret:string):any{\n    const [ciphertext,iv,tag] = encrypted.split(delimiter);\n    const serialized = Aes.decrypt(ciphertext,iv,tag,secret);\n    const deserialized = eval('(' + serialized + ')');\n    return deserialized.DECRYPTED;\n}\n\nexport {\n    encrypt,\n    decrypt,\n}\n"],"names":["Aes","require","serializeOptions","ignoreFunction","delimiter","encrypt","decrypted","secret","Error","randomBytes","toString","obj","DECRYPTED","serialized","JSON","stringify","serialize","res","encrypted","ciphertext","iv","tag","decrypt","split","deserialized","eval"],"mappings":";;;;;;;;;AAEA,IAAMA,GAAG,gBAAGC,OAAO,CAAC,aAAD,CAAnB;AAGA,IAAMC,gBAAgB,GAAsB;EACxCC,cAAc,EAAC;AADyB,CAA5C;AAGA,IAAMC,SAAS,YAAf;;AACA,SAASC,OAAT,CAAiBC,SAAjB,EAA+BC,MAA/B;EACI,IAAG,OAAOD,SAAP,IAAoB,WAAvB,EAAoC,MAAM,IAAIE,KAAJ,CAAU,wBAAV,CAAN;;EACpC,IAAG,OAAOD,MAAP,IAAiB,QAAjB,IAA6BA,MAAM,IAAI,IAA1C,EAAgD;IAC5CA,MAAM,GAAGE,kBAAW,CAAC,EAAD,CAAX,CAAgBC,QAAhB,CAAyB,KAAzB,CAAT;;;EAEJ,IAAMC,GAAG,GAAG;IAACC,SAAS,EAACN;GAAvB;EACA,IAAIO,UAAU,GAAQ,EAAtB;;EACA,IAAG;IACCA,UAAU,GAAGC,IAAI,CAACC,SAAL,CAAeJ,GAAf,CAAb;GADJ,CAEE,gBAAM;IACJE,UAAU,GAAIG,SAAS,CAACL,GAAD,EAAMT,gBAAN,CAAvB;;;EAIJ,IAAMe,GAAG,GAAGjB,GAAG,CAACK,OAAJ,CAAYQ,UAAZ,EAAuBN,MAAvB,CAAZ;EACA,IAAMW,SAAS,QAAMD,GAAG,CAACE,UAAV,GAAuBf,SAAvB,GAAmCa,GAAG,CAACG,EAAvC,GAA4ChB,SAA5C,GAAwDa,GAAG,CAACI,GAA3E;EACA,OAAOH,SAAP;AACH;;AACD,SAASI,OAAT,CAAiBJ,SAAjB,EAAkCX,MAAlC;EACI,uBAA4BW,SAAS,CAACK,KAAV,CAAgBnB,SAAhB,CAA5B;MAAOe,UAAP;MAAkBC,EAAlB;MAAqBC,GAArB;;EACA,IAAMR,UAAU,GAAGb,GAAG,CAACsB,OAAJ,CAAYH,UAAZ,EAAuBC,EAAvB,EAA0BC,GAA1B,EAA8Bd,MAA9B,CAAnB;EACA,IAAMiB,YAAY,GAAGC,IAAI,CAAC,MAAMZ,UAAN,GAAmB,GAApB,CAAzB;EACA,OAAOW,YAAY,CAACZ,SAApB;AACH;;;;;"}